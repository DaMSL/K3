declare final : mut int = 0

trigger start : int = \n -> (fibonacci, me) <- (n, 0, 1)

trigger fibonacci : (immut int, immut int, immut int) = \x ->
  bind x as (n,a,b) in
  if n <= 1
  then (result, 127.0.0.1:40000) <- b
  else (fibonacci, 127.0.0.1:40000) <- (n - 1, b, a + b)

trigger result : int = \x -> final = x

source s1 : int = value 5

~~ s1 |> start
